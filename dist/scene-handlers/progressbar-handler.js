"use strict";
/**
 * ProgressBar UI 创建处理器
 * 在场景脚本上下文中执行，可以直接访问 cc 对象
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.createProgressBarWithTemplate = createProgressBarWithTemplate;
function createProgressBarWithTemplate(name, parentUuid, width, height, getCC, markSceneDirty) {
    var _a;
    try {
        const { director, Node } = getCC();
        const scene = director.getScene();
        if (!scene) {
            return { success: false, error: 'No active scene' };
        }
        const BG_SPRITE = '88e79fd5-96b4-4a77-a1f4-312467171014';
        const BAR_SPRITE = '67e68bc9-dad5-4ad9-a2d8-7e03d458e32f';
        // 1. 主节点
        const progressNode = new Node(name);
        const parent = parentUuid ? scene.getChildByUuid(parentUuid) : scene;
        (parent || scene).addChild(progressNode);
        progressNode.setContentSize(width, height);
        progressNode.setAnchorPoint(0.5, 0.5);
        // 背景
        const bgSprite = progressNode.addComponent(cc.Sprite);
        bgSprite.type = cc.Sprite.Type.SLICED;
        bgSprite.sizeMode = cc.Sprite.SizeMode.CUSTOM;
        const bgFrame = new cc.SpriteFrame();
        bgFrame._uuid = BG_SPRITE;
        bgSprite.spriteFrame = bgFrame;
        // 2. bar
        const barNode = new Node('bar');
        progressNode.addChild(barNode);
        barNode.setContentSize(width / 2, height);
        barNode.setAnchorPoint(0, 0.5);
        barNode.setPosition(-width / 2, 0);
        const barSprite = barNode.addComponent(cc.Sprite);
        barSprite.type = cc.Sprite.Type.SLICED;
        barSprite.sizeMode = cc.Sprite.SizeMode.CUSTOM;
        const barFrame = new cc.SpriteFrame();
        barFrame._uuid = BAR_SPRITE;
        barSprite.spriteFrame = barFrame;
        // 3. ProgressBar 组件
        const progressComp = progressNode.addComponent(cc.ProgressBar);
        progressComp.barSprite = barSprite;
        progressComp.totalLength = width;
        progressComp.mode = cc.ProgressBar.Mode.HORIZONTAL;
        progressComp.progress = 0.5;
        progressComp.reverse = false;
        markSceneDirty();
        try {
            if (typeof Editor !== 'undefined' && ((_a = Editor.Ipc) === null || _a === void 0 ? void 0 : _a.sendToPanel)) {
                Editor.Ipc.sendToPanel('scene', 'scene:soft-reload');
            }
        }
        catch (error) {
            console.warn('[scene-script] Failed to refresh scene view:', error);
        }
        return {
            success: true,
            message: `ProgressBar '${name}' created successfully`,
            data: {
                uuid: progressNode.uuid || progressNode._id,
                name: progressNode.name || progressNode._name,
                width,
                height
            }
        };
    }
    catch (error) {
        return { success: false, error: error.message || error };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZ3Jlc3NiYXItaGFuZGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY2VuZS1oYW5kbGVycy9wcm9ncmVzc2Jhci1oYW5kbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBRUgsc0VBNkVDO0FBN0VELFNBQWdCLDZCQUE2QixDQUN6QyxJQUFZLEVBQ1osVUFBeUIsRUFDekIsS0FBYSxFQUNiLE1BQWMsRUFDZCxLQUFnQixFQUNoQixjQUEwQjs7SUFFMUIsSUFBSSxDQUFDO1FBQ0QsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsR0FBRyxLQUFLLEVBQUUsQ0FBQztRQUNuQyxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDbEMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ1QsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLGlCQUFpQixFQUFFLENBQUM7UUFDeEQsQ0FBQztRQUVELE1BQU0sU0FBUyxHQUFHLHNDQUFzQyxDQUFDO1FBQ3pELE1BQU0sVUFBVSxHQUFHLHNDQUFzQyxDQUFDO1FBRTFELFNBQVM7UUFDVCxNQUFNLFlBQVksR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNwQyxNQUFNLE1BQU0sR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztRQUNyRSxDQUFDLE1BQU0sSUFBSSxLQUFLLENBQUMsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDekMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDM0MsWUFBWSxDQUFDLGNBQWMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFFdEMsS0FBSztRQUNMLE1BQU0sUUFBUSxHQUFHLFlBQVks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QUFLLEVBQUUsQ0FBQztJQUM3RCxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvZ3Jlc3NCYXIgVUkg5Yib5bu65aSE55CG5ZmoXG4gKiDlnKjlnLrmma/ohJrmnKzkuIrkuIvmlofkuK3miafooYzvvIzlj6/ku6Xnm7TmjqXorr/pl64gY2Mg5a+56LGhXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb2dyZXNzQmFyV2l0aFRlbXBsYXRlKFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICBwYXJlbnRVdWlkOiBzdHJpbmcgfCBudWxsLFxuICAgIHdpZHRoOiBudW1iZXIsXG4gICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgZ2V0Q0M6ICgpID0+IGFueSxcbiAgICBtYXJrU2NlbmVEaXJ0eTogKCkgPT4gdm9pZFxuKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBkaXJlY3RvciwgTm9kZSB9ID0gZ2V0Q0MoKTtcbiAgICAgICAgY29uc3Qgc2NlbmUgPSBkaXJlY3Rvci5nZXRTY2VuZSgpO1xuICAgICAgICBpZiAoIXNjZW5lKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdObyBhY3RpdmUgc2NlbmUnIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBCR19TUFJJVEUgPSAnODhlNzlmZDUtOTZiNC00YTc3LWExZjQtMzEyNDY3MTcxMDE0JztcbiAgICAgICAgY29uc3QgQkFSX1NQUklURSA9ICc2N2U2OGJjOS1kYWQ1LTRhZDktYTJkOC03ZTAzZDQ1OGUzMmYnO1xuXG4gICAgICAgIC8vIDEuIOS4u+iKgueCuVxuICAgICAgICBjb25zdCBwcm9ncmVzc05vZGUgPSBuZXcgTm9kZShuYW1lKTtcbiAgICAgICAgY29uc3QgcGFyZW50ID0gcGFyZW50VXVpZCA/IHNjZW5lLmdldENoaWxkQnlVdWlkKHBhcmVudFV1aWQpIDogc2NlbmU7XG4gICAgICAgIChwYXJlbnQgfHwgc2NlbmUpLmFkZENoaWxkKHByb2dyZXNzTm9kZSk7XG4gICAgICAgIHByb2dyZXNzTm9kZS5zZXRDb250ZW50U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgcHJvZ3Jlc3NOb2RlLnNldEFuY2hvclBvaW50KDAuNSwgMC41KTtcblxuICAgICAgICAvLyDog4zmma9cbiAgICAgICAgY29uc3QgYmdTcHJpdGUgPSBwcm9ncmVzc05vZGUuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIGJnU3ByaXRlLnR5cGUgPSBjYy5TcHJpdGUuVHlwZS5TTElDRUQ7XG4gICAgICAgIGJnU3ByaXRlLnNpemVNb2RlID0gY2MuU3ByaXRlLlNpemVNb2RlLkNVU1RPTTtcbiAgICAgICAgY29uc3QgYmdGcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSgpO1xuICAgICAgICAoYmdGcmFtZSBhcyBhbnkpLl91dWlkID0gQkdfU1BSSVRFO1xuICAgICAgICBiZ1Nwcml0ZS5zcHJpdGVGcmFtZSA9IGJnRnJhbWU7XG5cbiAgICAgICAgLy8gMi4gYmFyXG4gICAgICAgIGNvbnN0IGJhck5vZGUgPSBuZXcgTm9kZSgnYmFyJyk7XG4gICAgICAgIHByb2dyZXNzTm9kZS5hZGRDaGlsZChiYXJOb2RlKTtcbiAgICAgICAgYmFyTm9kZS5zZXRDb250ZW50U2l6ZSh3aWR0aCAvIDIsIGhlaWdodCk7XG4gICAgICAgIGJhck5vZGUuc2V0QW5jaG9yUG9pbnQoMCwgMC41KTtcbiAgICAgICAgYmFyTm9kZS5zZXRQb3NpdGlvbigtd2lkdGggLyAyLCAwKTtcblxuICAgICAgICBjb25zdCBiYXJTcHJpdGUgPSBiYXJOb2RlLmFkZENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICBiYXJTcHJpdGUudHlwZSA9IGNjLlNwcml0ZS5UeXBlLlNMSUNFRDtcbiAgICAgICAgYmFyU3ByaXRlLnNpemVNb2RlID0gY2MuU3ByaXRlLlNpemVNb2RlLkNVU1RPTTtcbiAgICAgICAgY29uc3QgYmFyRnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoKTtcbiAgICAgICAgKGJhckZyYW1lIGFzIGFueSkuX3V1aWQgPSBCQVJfU1BSSVRFO1xuICAgICAgICBiYXJTcHJpdGUuc3ByaXRlRnJhbWUgPSBiYXJGcmFtZTtcblxuICAgICAgICAvLyAzLiBQcm9ncmVzc0JhciDnu4Tku7ZcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NDb21wID0gcHJvZ3Jlc3NOb2RlLmFkZENvbXBvbmVudChjYy5Qcm9ncmVzc0Jhcik7XG4gICAgICAgIHByb2dyZXNzQ29tcC5iYXJTcHJpdGUgPSBiYXJTcHJpdGU7XG4gICAgICAgIHByb2dyZXNzQ29tcC50b3RhbExlbmd0aCA9IHdpZHRoO1xuICAgICAgICBwcm9ncmVzc0NvbXAubW9kZSA9IGNjLlByb2dyZXNzQmFyLk1vZGUuSE9SSVpPTlRBTDtcbiAgICAgICAgcHJvZ3Jlc3NDb21wLnByb2dyZXNzID0gMC41O1xuICAgICAgICBwcm9ncmVzc0NvbXAucmV2ZXJzZSA9IGZhbHNlO1xuXG4gICAgICAgIG1hcmtTY2VuZURpcnR5KCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIEVkaXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgRWRpdG9yLklwYz8uc2VuZFRvUGFuZWwpIHtcbiAgICAgICAgICAgICAgICBFZGl0b3IuSXBjLnNlbmRUb1BhbmVsKCdzY2VuZScsICdzY2VuZTpzb2Z0LXJlbG9hZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdbc2NlbmUtc2NyaXB0XSBGYWlsZWQgdG8gcmVmcmVzaCBzY2VuZSB2aWV3OicsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgbWVzc2FnZTogYFByb2dyZXNzQmFyICcke25hbWV9JyBjcmVhdGVkIHN1Y2Nlc3NmdWxseWAsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgdXVpZDogcHJvZ3Jlc3NOb2RlLnV1aWQgfHwgcHJvZ3Jlc3NOb2RlLl9pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBwcm9ncmVzc05vZGUubmFtZSB8fCBwcm9ncmVzc05vZGUuX25hbWUsXG4gICAgICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IgfTtcbiAgICB9XG59XG4iXX0=