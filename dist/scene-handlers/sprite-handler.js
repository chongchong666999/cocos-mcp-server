"use strict";
/**
 * Sprite UI 创建处理器
 * 在场景脚本上下文中执行，可以直接访问 cc 对象
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.createSpriteWithTemplate = createSpriteWithTemplate;
/**
 * 创建 Sprite 组件
 * @param name Sprite 节点名称
 * @param parentUuid 父节点 UUID
 * @param width Sprite 宽度
 * @param height Sprite 高度
 * @param spriteFrameUuid Sprite Frame UUID
 * @param getCC 获取 Cocos 引擎实例的函数
 * @param markSceneDirty 标记场景为脏的函数
 */
function createSpriteWithTemplate(name, parentUuid, width, height, spriteFrameUuid, getCC, markSceneDirty) {
    try {
        const { director, Node } = getCC();
        const scene = director.getScene();
        if (!scene) {
            return { success: false, error: 'No active scene' };
        }
        // 1. 创建主节点
        const spriteNode = new Node(name);
        const parent = parentUuid ? scene.getChildByUuid(parentUuid) : scene;
        if (parent) {
            parent.addChild(spriteNode);
        }
        else {
            scene.addChild(spriteNode);
        }
        // 设置主节点大小和锚点
        spriteNode.setContentSize(width, height);
        spriteNode.setAnchorPoint(0.5, 0.5);
        // 2. 添加 Sprite 组件
        const spriteComp = spriteNode.addComponent(cc.Sprite);
        spriteComp.type = cc.Sprite.Type.SIMPLE; // 0 - SIMPLE 模式
        spriteComp.sizeMode = cc.Sprite.SizeMode.TRIMMED; // 1 - TRIMMED 模式
        // 设置 SpriteFrame 的 UUID
        const spriteFrame = new cc.SpriteFrame();
        spriteFrame._uuid = spriteFrameUuid;
        spriteComp.spriteFrame = spriteFrame;
        // 标记场景为已修改并保存
        markSceneDirty();
        // 通知编辑器刷新场景视图
        try {
            if (typeof Editor !== 'undefined' && Editor.Ipc && Editor.Ipc.sendToPanel) {
                Editor.Ipc.sendToPanel('scene', 'scene:soft-reload');
            }
        }
        catch (error) {
            console.warn('[scene-script] Failed to refresh scene view:', error);
        }
        return {
            success: true,
            message: `Sprite '${name}' created successfully`,
            data: {
                uuid: spriteNode.uuid || spriteNode._id,
                name: spriteNode.name || spriteNode._name,
                width: width,
                height: height,
                spriteFrame: spriteFrameUuid
            }
        };
    }
    catch (error) {
        return {
            success: false,
            error: error.message || error
        };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ByaXRlLWhhbmRsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NlbmUtaGFuZGxlcnMvc3ByaXRlLWhhbmRsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7QUFZSCw0REFvRUM7QUE5RUQ7Ozs7Ozs7OztHQVNHO0FBQ0gsU0FBZ0Isd0JBQXdCLENBQ3BDLElBQVksRUFDWixVQUF5QixFQUN6QixLQUFhLEVBQ2IsTUFBYyxFQUNkLGVBQXVCLEVBQ3ZCLEtBQWdCLEVBQ2hCLGNBQTBCO0lBRTFCLElBQUksQ0FBQztRQUNELE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLEdBQUcsS0FBSyxFQUFFLENBQUM7UUFDbkMsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2xDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNULE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxpQkFBaUIsRUFBRSxDQUFDO1FBQ3hELENBQUM7UUFFRCxXQUFXO1FBQ1gsTUFBTSxVQUFVLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEMsTUFBTSxNQUFNLEdBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFDckUsSUFBSSxNQUFNLEVBQUUsQ0FBQztZQUNULE1BQU0sQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDaEMsQ0FBQzthQUFNLENBQUM7WUFDSixLQUFLLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQy9CLENBQUM7UUFFRCxhQUFhO1FBQ2IsVUFBVSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDekMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFFcEMsa0JBQWtCO1FBQ2xCLE1BQU0sVUFBVSxHQUFHLFVBQVUsQ0FBQyxZQUFZLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3RELFVBQVUsQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsZ0JBQWdCO1FBQ3pELFVBQVUsQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsaUJBQWlCO1FBRW5FLHdCQUF3QjtRQUN4QixNQUFNLFdBQVcsR0FBRyxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUN4QyxXQUFtQixDQUFDLEtBQUssR0FBRyxlQUFlLENBQUM7UUFDN0MsVUFBVSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFFckMsY0FBYztRQUNkLGNBQWMsRUFBRSxDQUFDO1FBRWpCLGNBQWM7UUFDZCxJQUFJLENBQUM7WUFDRCxJQUFJLE9BQU8sTUFBTSxLQUFLLFdBQVcsSUFBSSxNQUFNLENBQUMsR0FBRyxJQUFJLE1BQU0sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ3hFLE1BQU0sQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1lBQ3pELENBQUM7UUFDTCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNiLE9BQU8sQ0FBQyxJQUFJLENBQUMsOENBQThDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDeEUsQ0FBQztRQUVELE9BQU87WUFDSCxPQUFPLEVBQUUsSUFBSTtZQUNiLE9BQU8sRUFBRSxXQUFXLElBQUksd0JBQXdCO1lBQ2hELElBQUksRUFBRTtnQkFDRixJQUFJLEVBQUUsVUFBVSxDQUFDLElBQUksSUFBSSxVQUFVLENBQUMsR0FBRztnQkFDdkMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxJQUFJLElBQUksVUFBVSxDQUFDLEtBQUs7Z0JBQ3pDLEtBQUssRUFBRSxLQUFLO2dCQUNaLE1BQU0sRUFBRSxNQUFNO2dCQUNkLFdBQVcsRUFBRSxlQUFlO2FBQy9CO1NBQ0osQ0FBQztJQUNOLENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ2xCLE9BQU87WUFDSCxPQUFPLEVBQUUsS0FBSztZQUNkLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxJQUFJLEtBQUs7U0FDaEMsQ0FBQztJQUNOLENBQUM7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTcHJpdGUgVUkg5Yib5bu65aSE55CG5ZmoXG4gKiDlnKjlnLrmma/ohJrmnKzkuIrkuIvmlofkuK3miafooYzvvIzlj6/ku6Xnm7TmjqXorr/pl64gY2Mg5a+56LGhXG4gKi9cblxuLyoqXG4gKiDliJvlu7ogU3ByaXRlIOe7hOS7tlxuICogQHBhcmFtIG5hbWUgU3ByaXRlIOiKgueCueWQjeensFxuICogQHBhcmFtIHBhcmVudFV1aWQg54i26IqC54K5IFVVSURcbiAqIEBwYXJhbSB3aWR0aCBTcHJpdGUg5a695bqmXG4gKiBAcGFyYW0gaGVpZ2h0IFNwcml0ZSDpq5jluqZcbiAqIEBwYXJhbSBzcHJpdGVGcmFtZVV1aWQgU3ByaXRlIEZyYW1lIFVVSURcbiAqIEBwYXJhbSBnZXRDQyDojrflj5YgQ29jb3Mg5byV5pOO5a6e5L6L55qE5Ye95pWwXG4gKiBAcGFyYW0gbWFya1NjZW5lRGlydHkg5qCH6K6w5Zy65pmv5Li66ISP55qE5Ye95pWwXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTcHJpdGVXaXRoVGVtcGxhdGUoXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIHBhcmVudFV1aWQ6IHN0cmluZyB8IG51bGwsXG4gICAgd2lkdGg6IG51bWJlcixcbiAgICBoZWlnaHQ6IG51bWJlcixcbiAgICBzcHJpdGVGcmFtZVV1aWQ6IHN0cmluZyxcbiAgICBnZXRDQzogKCkgPT4gYW55LFxuICAgIG1hcmtTY2VuZURpcnR5OiAoKSA9PiB2b2lkXG4pIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGRpcmVjdG9yLCBOb2RlIH0gPSBnZXRDQygpO1xuICAgICAgICBjb25zdCBzY2VuZSA9IGRpcmVjdG9yLmdldFNjZW5lKCk7XG4gICAgICAgIGlmICghc2NlbmUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vIGFjdGl2ZSBzY2VuZScgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDEuIOWIm+W7uuS4u+iKgueCuVxuICAgICAgICBjb25zdCBzcHJpdGVOb2RlID0gbmV3IE5vZGUobmFtZSk7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHBhcmVudFV1aWQgPyBzY2VuZS5nZXRDaGlsZEJ5VXVpZChwYXJlbnRVdWlkKSA6IHNjZW5lO1xuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICBwYXJlbnQuYWRkQ2hpbGQoc3ByaXRlTm9kZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzY2VuZS5hZGRDaGlsZChzcHJpdGVOb2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIOiuvue9ruS4u+iKgueCueWkp+Wwj+WSjOmUmueCuVxuICAgICAgICBzcHJpdGVOb2RlLnNldENvbnRlbnRTaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICBzcHJpdGVOb2RlLnNldEFuY2hvclBvaW50KDAuNSwgMC41KTtcblxuICAgICAgICAvLyAyLiDmt7vliqAgU3ByaXRlIOe7hOS7tlxuICAgICAgICBjb25zdCBzcHJpdGVDb21wID0gc3ByaXRlTm9kZS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgc3ByaXRlQ29tcC50eXBlID0gY2MuU3ByaXRlLlR5cGUuU0lNUExFOyAvLyAwIC0gU0lNUExFIOaooeW8j1xuICAgICAgICBzcHJpdGVDb21wLnNpemVNb2RlID0gY2MuU3ByaXRlLlNpemVNb2RlLlRSSU1NRUQ7IC8vIDEgLSBUUklNTUVEIOaooeW8j1xuICAgICAgICBcbiAgICAgICAgLy8g6K6+572uIFNwcml0ZUZyYW1lIOeahCBVVUlEXG4gICAgICAgIGNvbnN0IHNwcml0ZUZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKCk7XG4gICAgICAgIChzcHJpdGVGcmFtZSBhcyBhbnkpLl91dWlkID0gc3ByaXRlRnJhbWVVdWlkO1xuICAgICAgICBzcHJpdGVDb21wLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cbiAgICAgICAgLy8g5qCH6K6w5Zy65pmv5Li65bey5L+u5pS55bm25L+d5a2YXG4gICAgICAgIG1hcmtTY2VuZURpcnR5KCk7XG4gICAgICAgIFxuICAgICAgICAvLyDpgJrnn6XnvJbovpHlmajliLfmlrDlnLrmma/op4blm75cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgRWRpdG9yICE9PSAndW5kZWZpbmVkJyAmJiBFZGl0b3IuSXBjICYmIEVkaXRvci5JcGMuc2VuZFRvUGFuZWwpIHtcbiAgICAgICAgICAgICAgICBFZGl0b3IuSXBjLnNlbmRUb1BhbmVsKCdzY2VuZScsICdzY2VuZTpzb2Z0LXJlbG9hZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdbc2NlbmUtc2NyaXB0XSBGYWlsZWQgdG8gcmVmcmVzaCBzY2VuZSB2aWV3OicsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgbWVzc2FnZTogYFNwcml0ZSAnJHtuYW1lfScgY3JlYXRlZCBzdWNjZXNzZnVsbHlgLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHV1aWQ6IHNwcml0ZU5vZGUudXVpZCB8fCBzcHJpdGVOb2RlLl9pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBzcHJpdGVOb2RlLm5hbWUgfHwgc3ByaXRlTm9kZS5fbmFtZSxcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgICAgICAgICAgc3ByaXRlRnJhbWU6IHNwcml0ZUZyYW1lVXVpZFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgZXJyb3JcbiAgICAgICAgfTtcbiAgICB9XG59XG4iXX0=