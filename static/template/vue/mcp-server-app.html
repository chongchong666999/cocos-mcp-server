<div class="mcp-app">
    <div class="tab-bar">
        <div
            class="tab-item"
            :class="{ active: activeTab === 'server' }"
            @click="switchTab('server')">
            服务器
        </div>
        <div
            class="tab-item"
            :class="{ active: activeTab === 'tools' }"
            @click="switchTab('tools')">
            工具管理
        </div>
    </div>

    <div class="tab-panel" v-show="activeTab === 'server'">
        <div class="card">
            <div class="card-header">服务器状态</div>
            <div class="card-body status-grid">
                <div class="status-row">
                    <span class="status-label">状态</span>
                    <span :class="['status-value', statusClass]">{{ serverStatus }}</span>
                </div>
                <div class="status-row">
                    <span class="status-label">连接数</span>
                    <span class="status-value">{{ connectedClients }}</span>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-body action-area">
                <button class="primary-btn" :disabled="isProcessing" @click="toggleServer">
                    {{ serverRunning ? '停止服务器' : '启动服务器' }}
                </button>
            </div>
        </div>

        <div class="card">
            <div class="card-header">服务器设置</div>
            <div class="card-body form-grid">
                <label class="form-item">
                    <span class="form-label">端口</span>
                    <input
                        type="number"
                        v-model.number="settings.port"
                        :disabled="serverRunning"
                        min="1024"
                        max="65535">
                </label>
                <label class="form-item checkbox">
                    <input type="checkbox" v-model="settings.autoStart">
                    <span>自动启动</span>
                </label>
                <label class="form-item checkbox">
                    <input type="checkbox" v-model="settings.debugLog">
                    <span>调试日志</span>
                </label>
                <label class="form-item">
                    <span class="form-label">最大连接数</span>
                    <input
                        type="number"
                        v-model.number="settings.maxConnections"
                        min="1"
                        max="100">
                </label>
            </div>
        </div>

        <div class="card" v-if="serverRunning">
            <div class="card-header">连接信息</div>
            <div class="card-body">
                <div class="status-row">
                    <span class="status-label">HTTP URL</span>
                    <div class="url-field">
                        <input type="text" :value="httpUrl" readonly>
                        <button @click="copyUrl">复制</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer-actions">
            <button class="primary-btn" :disabled="!settingsChanged" @click="saveSettings">
                保存设置
            </button>
        </div>
    </div>

    <div class="tab-panel" v-show="activeTab === 'tools'">
        <div class="card">
            <div class="card-header">工具管理</div>
            <div class="card-body tools-section">
                <div class="tools-section-header">
                    <div class="tools-section-title">
                        <h4>可用工具</h4>
                        <div class="tools-stats">
                            {{ totalTools }} 个工具
                            ({{ enabledTools }} 启用 / {{ disabledTools }} 禁用)
                        </div>
                    </div>
                    <div class="tools-section-controls">
                        <button class="ghost-btn" @click="selectAllTools">全选</button>
                        <button class="ghost-btn" @click="deselectAllTools">取消全选</button>
                        <button class="primary-btn" @click="saveChanges">保存更改</button>
                    </div>
                </div>

                <div class="tools-container">
                    <div
                        v-for="category in toolCategories"
                        :key="category"
                        class="tool-category">
                        <div class="category-header">
                            <h5>{{ getCategoryDisplayName(category) }}</h5>
                            <div class="category-controls">
                                <button class="ghost-btn" @click="toggleCategoryTools(category, true)">全选</button>
                                <button class="ghost-btn" @click="toggleCategoryTools(category, false)">取消全选</button>
                            </div>
                        </div>
                        <div class="tool-items">
                            <label
                                v-for="tool in getToolsByCategory(category)"
                                :key="tool.name"
                                class="tool-item">
                                <input
                                    type="checkbox"
                                    :checked="tool.enabled"
                                    @change="onToolToggle(category, tool.name, $event)">
                                <div class="tool-info">
                                    <div class="tool-name">{{ tool.name }}</div>
                                    <div class="tool-description">{{ tool.description }}</div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
